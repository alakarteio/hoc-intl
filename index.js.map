{"version":3,"file":"index.js","sources":["src/getLocale.js","src/format.js","src/core.jsx"],"sourcesContent":["export default (context) => {\n  if (!context.store\n    || !context.store.getState()\n    || !context.store.getState().config\n    || !context.store.getState().config.locale) {\n    throw new Error('/ HOC k-intl / locale is not readable. make sure that this one is available at `config.local` on your redux store')\n  }\n  return context.store.getState().config.locale\n}\n","import { get, template } from 'lodash'\n\nconst interpolate = /{{([\\s\\S]+?)}}/g\nconst defaultLabel = {}\n\nexport default locale => (config, componentProps) =>\n  Object\n    .keys(config)\n    .reduce((acc, curr) => {\n      const label = get(locale, config[curr])\n      if (componentProps && componentProps[curr]) {\n        return { ...acc, [curr]: template(label, { interpolate })(componentProps[curr]) }\n      }\n      return { ...acc, [curr]: label }\n    }, defaultLabel)\n","import React, { Component } from 'react'\nimport { shallowEqual, wrapDisplayName } from 'recompose'\nimport getLocale from './getLocale'\nimport format from './format'\n\nexport default config => WrappedComponent => class extends Component {\n  static displayName = wrapDisplayName(WrappedComponent, 'Intl')\n\n  static contextTypes = {\n    store: () => null, // this is to avoid importing prop-types\n  }\n\n  constructor(props, context) {\n    super(props, context)\n    this.labels = {}\n    this.state = {\n      injectedProps: {},\n    }\n  }\n\n  componentWillMount() {\n    this.unsubscribe = this.context.store.subscribe(() => { this.format() })\n    this.format()\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.format(nextProps)\n  }\n\n  componentWillUnmount() {\n    this.unsubscribe()\n  }\n\n  format = (nextProps) => {\n    /* take locale on `config.locale` reducer */\n    const locale = getLocale(this.context)\n    const labels = format(locale)(\n      config,\n      nextProps || this.props,\n    )\n    /* not change labels when the sub store local not change */\n    if (shallowEqual(labels, this.labels)) return\n    this.labels = labels\n    this.setState(state => ({\n      ...state,\n      injectedProps: { labels },\n    }))\n  }\n\n  render() {\n    return (\n      <WrappedComponent\n        /* this is parent props */\n        {...this.props}\n        /* this is injected props from hoc */\n        {...this.state.injectedProps}\n      />\n    )\n  }\n}\n"],"names":["context","store","getState","config","locale","Error","interpolate","defaultLabel","componentProps","Object","keys","reduce","acc","curr","label","get","template","props","format","nextProps","getLocale","_this","labels","shallowEqual","setState","state","Component","unsubscribe","this","subscribe","React","WrappedComponent","injectedProps","displayName","wrapDisplayName","contextTypes"],"mappings":"kVAAgBA,QACTA,EAAQC,OACPD,EAAQC,MAAMC,YACdF,EAAQC,MAAMC,WAAWC,QACzBH,EAAQC,MAAMC,WAAWC,OAAOC,cAC9B,IAAIC,MAAM,4HAEXL,EAAQC,MAAMC,WAAWC,OAAOC,6xBCLnCE,EAAc,kBACdC,0BAEmB,SAACJ,EAAQK,UAChCC,OACGC,KAAKP,GACLQ,OAAO,SAACC,EAAKC,OACNC,EAAQC,MAAIX,EAAQD,EAAOU,WAC7BL,GAAkBA,EAAeK,QACvBD,OAAMC,EAAOG,WAASF,GAASR,eAAlBU,CAAiCR,EAAeK,WAE/DD,OAAMC,EAAOC,KACxBP,+BCTkB,sDAOXU,EAAOjB,4EACXiB,EAAOjB,aAoBfkB,OAAS,SAACC,OAEFf,EAASgB,EAAUC,EAAKrB,SACxBsB,EAASJ,EAAOd,EAAPc,CACbf,EACAgB,GAAaE,EAAKJ,OAGhBM,eAAaD,EAAQD,EAAKC,YACzBA,OAASA,IACTE,SAAS,wBACTC,kBACcH,kBA/BdA,YACAG,8VAVkDC,6EAgBlDC,YAAcC,KAAK5B,QAAQC,MAAM4B,UAAU,aAAaX,gBACxDA,2DAGmBC,QACnBD,OAAOC,uDAIPQ,sDAqBHG,gBAACC,OAEKH,KAAKX,MAELW,KAAKH,MAAMO,2BAjDdC,YAAcC,kBAAgBH,EAAkB,UAEhDI,oBACE,kBAAM"}