{"version":3,"file":"index.js","sources":["src/utils/wrapDisplayName.js","src/utils/storeSelector.js","src/utils/localeDataRegistry.js","src/en.js","src/format.js","src/core.jsx"],"sourcesContent":["export default (Component, wrapperName) => (\n  `${wrapperName || 'intl'} (${Component.displayName\n  || Component.name\n  || (Component.constructor && Component.constructor.name)\n  || 'Unknown'})`\n)\n","export const getLocale = (context) => {\n  if (!context.store\n    || !context.store.getState()\n    || !context.store.getState().config\n    || !context.store.getState().config.locale) {\n    throw new Error('/ HOC k-intl / locale is not readable. make sure that this one is available at `config.local` on your redux store')\n  }\n  return context.store.getState().config.locale\n}\n\nexport const getLang = (context) => {\n  if (!context.store\n    || !context.store.getState()\n    || !context.store.getState().config\n    || !context.store.getState().config.lang) {\n    throw new Error('/ HOC k-intl / lang is not readable. make sure that this one is available at `config.lang` on your redux store')\n  }\n  return context.store.getState().config.lang\n}\n\nexport const getFormats = (context) => {\n  if (!context.store\n    || !context.store.getState()\n    || !context.store.getState().config\n    || !context.store.getState().config.getFormats) {\n    return {}\n  }\n  return context.store.getState().config.lang\n}\n","import IntlMessageFormat from 'intl-messageformat'\n\n/* eslint no-underscore-dangle: 0 */\nexport default function (data = []) {\n  const locales = Array.isArray(data) ? data : [data]\n\n  locales.forEach((localeData) => {\n    if (localeData && localeData.locale) IntlMessageFormat.__addLocaleData(localeData)\n  })\n}\n","\n// GENERATED FILE\nexport default {\"locale\":\"en\",\"pluralRuleFunction\":function (n,ord){var s=String(n).split(\".\"),v0=!s[1],t0=Number(s[0])==n,n10=t0&&s[0].slice(-1),n100=t0&&s[0].slice(-2);if(ord)return n10==1&&n100!=11?\"one\":n10==2&&n100!=12?\"two\":n10==3&&n100!=13?\"few\":\"other\";return n==1&&v0?\"one\":\"other\"},\"fields\":{\"year\":{\"displayName\":\"year\",\"relative\":{\"0\":\"this year\",\"1\":\"next year\",\"-1\":\"last year\"},\"relativeTime\":{\"future\":{\"one\":\"in {0} year\",\"other\":\"in {0} years\"},\"past\":{\"one\":\"{0} year ago\",\"other\":\"{0} years ago\"}}},\"year-short\":{\"displayName\":\"yr.\",\"relative\":{\"0\":\"this yr.\",\"1\":\"next yr.\",\"-1\":\"last yr.\"},\"relativeTime\":{\"future\":{\"one\":\"in {0} yr.\",\"other\":\"in {0} yr.\"},\"past\":{\"one\":\"{0} yr. ago\",\"other\":\"{0} yr. ago\"}}},\"month\":{\"displayName\":\"month\",\"relative\":{\"0\":\"this month\",\"1\":\"next month\",\"-1\":\"last month\"},\"relativeTime\":{\"future\":{\"one\":\"in {0} month\",\"other\":\"in {0} months\"},\"past\":{\"one\":\"{0} month ago\",\"other\":\"{0} months ago\"}}},\"month-short\":{\"displayName\":\"mo.\",\"relative\":{\"0\":\"this mo.\",\"1\":\"next mo.\",\"-1\":\"last mo.\"},\"relativeTime\":{\"future\":{\"one\":\"in {0} mo.\",\"other\":\"in {0} mo.\"},\"past\":{\"one\":\"{0} mo. ago\",\"other\":\"{0} mo. ago\"}}},\"day\":{\"displayName\":\"day\",\"relative\":{\"0\":\"today\",\"1\":\"tomorrow\",\"-1\":\"yesterday\"},\"relativeTime\":{\"future\":{\"one\":\"in {0} day\",\"other\":\"in {0} days\"},\"past\":{\"one\":\"{0} day ago\",\"other\":\"{0} days ago\"}}},\"day-short\":{\"displayName\":\"day\",\"relative\":{\"0\":\"today\",\"1\":\"tomorrow\",\"-1\":\"yesterday\"},\"relativeTime\":{\"future\":{\"one\":\"in {0} day\",\"other\":\"in {0} days\"},\"past\":{\"one\":\"{0} day ago\",\"other\":\"{0} days ago\"}}},\"hour\":{\"displayName\":\"hour\",\"relative\":{\"0\":\"this hour\"},\"relativeTime\":{\"future\":{\"one\":\"in {0} hour\",\"other\":\"in {0} hours\"},\"past\":{\"one\":\"{0} hour ago\",\"other\":\"{0} hours ago\"}}},\"hour-short\":{\"displayName\":\"hr.\",\"relative\":{\"0\":\"this hour\"},\"relativeTime\":{\"future\":{\"one\":\"in {0} hr.\",\"other\":\"in {0} hr.\"},\"past\":{\"one\":\"{0} hr. ago\",\"other\":\"{0} hr. ago\"}}},\"minute\":{\"displayName\":\"minute\",\"relative\":{\"0\":\"this minute\"},\"relativeTime\":{\"future\":{\"one\":\"in {0} minute\",\"other\":\"in {0} minutes\"},\"past\":{\"one\":\"{0} minute ago\",\"other\":\"{0} minutes ago\"}}},\"minute-short\":{\"displayName\":\"min.\",\"relative\":{\"0\":\"this minute\"},\"relativeTime\":{\"future\":{\"one\":\"in {0} min.\",\"other\":\"in {0} min.\"},\"past\":{\"one\":\"{0} min. ago\",\"other\":\"{0} min. ago\"}}},\"second\":{\"displayName\":\"second\",\"relative\":{\"0\":\"now\"},\"relativeTime\":{\"future\":{\"one\":\"in {0} second\",\"other\":\"in {0} seconds\"},\"past\":{\"one\":\"{0} second ago\",\"other\":\"{0} seconds ago\"}}},\"second-short\":{\"displayName\":\"sec.\",\"relative\":{\"0\":\"now\"},\"relativeTime\":{\"future\":{\"one\":\"in {0} sec.\",\"other\":\"in {0} sec.\"},\"past\":{\"one\":\"{0} sec. ago\",\"other\":\"{0} sec. ago\"}}}}};\n  ","import { get } from 'lodash'\nimport IntlMessageFormat from 'intl-messageformat'\nimport defaultLocaleData from './en'\nimport { addLocaleData } from './utils'\n\nconst defaultLabel = {}\nconst browserLanguage = window.navigator.language || window.navigator.browserLanguage\n/* add default locale on startup, import on src folder */\naddLocaleData(defaultLocaleData)\n\nexport const formatter =\n  (lang, label = '', customFormat) => new IntlMessageFormat(label, lang, customFormat)\n\nexport default (locale, lang = browserLanguage, customFormats) => (config, componentProps) =>\n  Object\n    .keys(config)\n    .reduce((acc, curr) => {\n      const label = get(locale, config[curr])\n      if (label && componentProps && componentProps[curr]) {\n        /* use formatJS to parse message */\n        return {\n          ...acc,\n          [curr]: formatter(lang, label, customFormats).format(componentProps[curr]),\n        }\n      }\n      return { ...acc, [curr]: label }\n    }, defaultLabel)\n","import React, { Component } from 'react'\nimport shallowEqual from 'fbjs/lib/shallowEqual'\nimport { wrapDisplayName, getLocale, getLang, getFormats } from './utils'\nimport format from './format'\n\nexport default config => WrappedComponent => class extends Component {\n  static displayName = wrapDisplayName(WrappedComponent, 'Intl')\n\n  static contextTypes = {\n    store: () => null, // this is to avoid importing prop-types\n  }\n\n  constructor(props, context) {\n    super(props, context)\n    this.messages = {}\n    this.state = {\n      injectedProps: {},\n    }\n  }\n\n  componentWillMount() {\n    this.unsubscribe = this.context.store.subscribe(() => { this.inject() })\n    this.inject()\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.inject(nextProps)\n  }\n\n  componentWillUnmount() {\n    this.unsubscribe()\n  }\n\n  inject = (nextProps) => {\n    /* take locale on `config.locale` reducer */\n    const locale = getLocale(this.context)\n    const lang = getLang(this.context)\n    const formats = getFormats(this.context)\n    const messages = format(locale, lang, formats)(\n      config,\n      nextProps || this.props,\n    )\n    /* not change messages when the formated messages is identical */\n    if (shallowEqual(this.state.injectedProps.messages, messages)) return\n    this.setState(state => ({\n      ...state,\n      injectedProps: { messages },\n    }))\n  }\n\n  render() {\n    return (\n      <WrappedComponent\n        /* this is parent props */\n        {...this.props}\n        /* this is injected props from hoc */\n        {...this.state.injectedProps}\n      />\n    )\n  }\n}\n"],"names":["getLocale","context","store","getState","config","locale","Error","getLang","lang","getFormats","data","Array","isArray","forEach","localeData","IntlMessageFormat","__addLocaleData","pluralRuleFunction","n","ord","s","String","split","v0","t0","Number","n10","slice","n100","fields","year","displayName","relative","0","1","-1","relativeTime","future","one","other","past","year-short","month","month-short","day","day-short","hour","hour-short","minute","minute-short","second","second-short","browserLanguage","window","navigator","language","addLocaleData","defaultLocaleData","customFormats","componentProps","Object","keys","reduce","acc","curr","label","get","customFormat","formatter","format","defaultLabel","Component","props","inject","nextProps","_this","formats","messages","shallowEqual","state","injectedProps","setState","unsubscribe","this","subscribe","React","WrappedComponent","name","constructor","contextTypes"],"mappings":"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"}